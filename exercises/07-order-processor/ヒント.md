# ヒント: 過剰なネスト

## 問題点

このコードには以下の問題があります：

1. **深すぎるネスト**
   - 最大で6〜7レベルのネストがある
   - コードの流れを追うのが困難

2. **可読性の低下**
   - インデントが深くなり、画面に収まらない
   - どの条件がどこまで影響するのか分かりにくい

3. **保守性の低下**
   - 条件を追加・変更する際に全体の構造を理解する必要がある
   - バグが混入しやすい

4. **テストの困難さ**
   - 全てのパスをテストするのが大変
   - エッジケースを見落としやすい

## 改善のポイント

### 1. ガード節（Early Return）の活用

- エラーケースを先にチェックして早期リターン
- 正常系のコードをネストの浅い位置に配置

```typescript
// Before
if (条件A) {
  if (条件B) {
    // 処理
  } else {
    return "エラーB";
  }
} else {
  return "エラーA";
}

// After
if (!条件A) {
  return "エラーA";
}
if (!条件B) {
  return "エラーB";
}
// 処理
```

### 2. 関数の分割

- 複雑な処理を小さな関数に分割
- 各関数が単一の責務を持つようにする

### 3. 条件の反転

- 否定条件を使って早期リターンを実現
- 正常系のコードを浅い位置に

### 4. 中間変数の活用

- 複雑な条件式を変数に抽出
- 意味のある名前を付けることで可読性向上

## 考えてみよう

- どの部分を別の関数に切り出すべきですか？
- どの順番でバリデーションを行うべきですか？
- エラーハンドリングの方法は適切ですか？
- 各関数の責務は明確ですか?
